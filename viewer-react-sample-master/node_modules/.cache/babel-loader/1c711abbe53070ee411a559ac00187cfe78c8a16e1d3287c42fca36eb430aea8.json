{"ast":null,"code":"import { useVisibility } from '../context/VisibilityContext';\nclass HandleSelectionExtension extends Autodesk.Viewing.Extension {\n  constructor(viewer, options) {\n    super(viewer, options);\n    this._group = null;\n    this._button = null;\n    this._button2 = null;\n    this._data = null;\n  }\n  load() {\n    console.log('HandleSelectionExtension has been loaded');\n    return true;\n  }\n  unload() {\n    // Clean our UI elements if we added any\n    if (this._group) {\n      this._group.removeControl(this._button);\n      if (this._group.getNumberOfControls() === 0) {\n        this.viewer.toolbar.removeControl(this._group);\n      }\n    }\n    console.log('HandleSelectionExtension has been unloaded');\n    return true;\n  }\n  onToolbarCreated() {\n    var _s = $RefreshSig$();\n    // Create a new toolbar group if it doesn't exist\n    this._group = this.viewer.toolbar.getControl('allMyAwesomeExtensionsToolbar');\n    if (!this._group) {\n      this._group = new Autodesk.Viewing.UI.ControlGroup('allMyAwesomeExtensionsToolbar');\n      this.viewer.toolbar.addControl(this._group);\n    }\n    window.toggleTabVisibility = _s(() => {\n      _s();\n      const {\n        toggleVisibility\n      } = useVisibility(); // Esto puede no funcionar directamente ya que useVisibility necesita un componente de React\n      toggleVisibility();\n    }, \"VpeFbZ23fhDnZgGhewpTLpLURdw=\", false, function () {\n      return [useVisibility];\n    });\n    // Add a new button to the toolbar group\n    this._button = new Autodesk.Viewing.UI.Button('handleSelectionExtensionButton');\n    this._gestorVistasButton = new Autodesk.Viewing.UI.Button('gestorVistasButton');\n    this._button.onClick = ev => {\n      console.log(\"detecto click\");\n      window.dispatchEvent(new CustomEvent('toggleTabVisibility'));\n      const selection = this.viewer.getSelection();\n      // this.viewer.clearSelection();\n      // Anything selected?\n      if (selection.length > 0) {\n        let isolated = [];\n        // Iterate through the list of selected dbIds\n        selection.forEach(dbId => {\n          // Get properties of each dbId\n          this.viewer.getProperties(dbId, props => {\n            // Output properties to console\n            console.log(props);\n            // Ask if want to isolate\n            /*                         if (confirm(`Isolate ${props.name} (${props.externalId})?`)) {\r\n                                        isolated.push(dbId);\r\n                                        this.viewer.isolate(isolated);\r\n                                    } */\n            isolated.push(dbId);\n            this.viewer.isolate(isolated);\n          });\n        });\n      } else {\n        // If nothing selected, restore\n        this.viewer.isolate(0);\n      }\n    };\n    this._gestorVistasButton.onClick = ev => {\n      // Aquí puedes agregar la lógica que se ejecutará cuando se haga clic en el botón\n      console.log('Botón gestorVistas pulsado');\n    };\n    this._button.setToolTip('Funciones ICD');\n    this._gestorVistasButton.setToolTip('Gestor de Vistas');\n    let iconPath = \"images/isotipoTransparente.png\";\n    this._button.icon.style = `background-image: url(${iconPath}); background-size: 22px 22px;`;\n    let iconPathGestorVistas = \"images/eyered.svg\"; // Reemplaza con la ruta de tu icono\n    this._gestorVistasButton.icon.style = `background-image: url(${iconPathGestorVistas}); background-size: 22px 22px;`;\n\n    // this._button.classList.add(\"fas\", \"fa-arrows-alt\");\n\n    //   this._button.addClass('handleSelectionExtensionIcon');\n    this._group.addControl(this._button);\n    this._group.addControl(this._gestorVistasButton);\n\n    //  this._button2.setToolTip('atBIM Button');\n    // this._button2.addClass('handleSelectionExtensionIcon');\n    //this._group.addControl(this._button2);\n  }\n  drawData() {\n    let _this = this;\n    console.log(this._data);\n    var div = document.getElementById('atbimPanel');\n    div.innerHTML = '<canvas id=\"myChart\" width=\"400\" height=\"400\"></canvas>';\n    var ctx = document.getElementById('myChart').getContext('2d');\n    let keys = Object.keys(this._data);\n    let values = Object.values(this._data).map(x => x.cantidad);\n    new Chart(ctx, {\n      type: 'bar',\n      data: {\n        labels: keys,\n        datasets: [{\n          label: 'Cantidad',\n          data: values,\n          backgroundColor: 'rgba(255, 99, 132, 0.2)',\n          borderColor: 'rgba(255, 99, 132, 1)',\n          borderWidth: 2\n        }]\n      },\n      options: {\n        'onClick': function (evento, item) {\n          if (item[0] !== undefined) {\n            let label = item[0]._model.label;\n            let dbIds = _this._data[label].dbIds;\n            _this.viewer.isolate(dbIds);\n            _this.viewer.fitToView(dbIds, _this.viewer.model);\n          }\n        },\n        scales: {\n          yAxes: [{\n            ticks: {\n              beginAtZero: true\n            }\n          }]\n        }\n      }\n    });\n  }\n}\nAutodesk.Viewing.theExtensionManager.registerExtension('HandleSelectionExtension', HandleSelectionExtension);","map":{"version":3,"names":["useVisibility","HandleSelectionExtension","Autodesk","Viewing","Extension","constructor","viewer","options","_group","_button","_button2","_data","load","console","log","unload","removeControl","getNumberOfControls","toolbar","onToolbarCreated","_s","$RefreshSig$","getControl","UI","ControlGroup","addControl","window","toggleTabVisibility","toggleVisibility","Button","_gestorVistasButton","onClick","ev","dispatchEvent","CustomEvent","selection","getSelection","length","isolated","forEach","dbId","getProperties","props","push","isolate","setToolTip","iconPath","icon","style","iconPathGestorVistas","drawData","_this","div","document","getElementById","innerHTML","ctx","getContext","keys","Object","values","map","x","cantidad","Chart","type","data","labels","datasets","label","backgroundColor","borderColor","borderWidth","evento","item","undefined","_model","dbIds","fitToView","model","scales","yAxes","ticks","beginAtZero","theExtensionManager","registerExtension"],"sources":["C:/Users/nicol/ProyectosWeb/icd/icd7/icd/src/extensions/HandleSelectionExtension.js"],"sourcesContent":["import { useVisibility } from '../context/VisibilityContext';\r\n\r\nclass HandleSelectionExtension extends Autodesk.Viewing.Extension {\r\n    constructor(viewer, options) {\r\n        super(viewer, options);\r\n        this._group = null;\r\n        this._button = null;\r\n        this._button2 = null;\r\n        this._data = null;\r\n    }\r\n\r\n    load() {\r\n        console.log('HandleSelectionExtension has been loaded');\r\n        return true;\r\n    }\r\n\r\n    unload() {\r\n        // Clean our UI elements if we added any\r\n        if (this._group) {\r\n            this._group.removeControl(this._button);\r\n            if (this._group.getNumberOfControls() === 0) {\r\n                this.viewer.toolbar.removeControl(this._group);\r\n            }\r\n        }\r\n        console.log('HandleSelectionExtension has been unloaded');\r\n        return true;\r\n    }\r\n\r\n    onToolbarCreated() {\r\n        // Create a new toolbar group if it doesn't exist\r\n        this._group = this.viewer.toolbar.getControl('allMyAwesomeExtensionsToolbar');\r\n        if (!this._group) {\r\n            this._group = new Autodesk.Viewing.UI.ControlGroup('allMyAwesomeExtensionsToolbar');\r\n            this.viewer.toolbar.addControl(this._group);\r\n        }\r\n        window.toggleTabVisibility = () => {\r\n            const { toggleVisibility } = useVisibility(); // Esto puede no funcionar directamente ya que useVisibility necesita un componente de React\r\n            toggleVisibility();\r\n        };\r\n        // Add a new button to the toolbar group\r\n        this._button = new Autodesk.Viewing.UI.Button('handleSelectionExtensionButton');\r\n        this._gestorVistasButton = new Autodesk.Viewing.UI.Button('gestorVistasButton');\r\n        this._button.onClick = (ev) => {\r\n           console.log(\"detecto click\");\r\n           window.dispatchEvent(new CustomEvent('toggleTabVisibility'));\r\n      \r\n            const selection = this.viewer.getSelection();\r\n           // this.viewer.clearSelection();\r\n            // Anything selected?\r\n            if (selection.length > 0) {\r\n                let isolated = [];\r\n                // Iterate through the list of selected dbIds\r\n                selection.forEach((dbId) => {\r\n                    // Get properties of each dbId\r\n                    this.viewer.getProperties(dbId, (props) => {\r\n                        // Output properties to console\r\n                        console.log(props);\r\n                        // Ask if want to isolate\r\n/*                         if (confirm(`Isolate ${props.name} (${props.externalId})?`)) {\r\n                            isolated.push(dbId);\r\n                            this.viewer.isolate(isolated);\r\n                        } */\r\n                        isolated.push(dbId);\r\n                        this.viewer.isolate(isolated);\r\n                    });\r\n                });\r\n            } else {\r\n                // If nothing selected, restore\r\n                this.viewer.isolate(0);\r\n            }\r\n        };\r\n\r\n        this._gestorVistasButton.onClick = (ev) => {\r\n            // Aquí puedes agregar la lógica que se ejecutará cuando se haga clic en el botón\r\n            console.log('Botón gestorVistas pulsado');\r\n        };\r\n        this._button.setToolTip('Funciones ICD');\r\n        this._gestorVistasButton.setToolTip('Gestor de Vistas');\r\n        let iconPath = \"images/isotipoTransparente.png\";\r\n        this._button.icon.style = `background-image: url(${iconPath}); background-size: 22px 22px;`;\r\n        let iconPathGestorVistas = \"images/eyered.svg\"; // Reemplaza con la ruta de tu icono\r\n        this._gestorVistasButton.icon.style = `background-image: url(${iconPathGestorVistas}); background-size: 22px 22px;`;\r\n\r\n        \r\n        \r\n      \r\n       // this._button.classList.add(\"fas\", \"fa-arrows-alt\");\r\n       \r\n     //   this._button.addClass('handleSelectionExtensionIcon');\r\n        this._group.addControl(this._button);\r\n        this._group.addControl(this._gestorVistasButton);\r\n    \r\n      //  this._button2.setToolTip('atBIM Button');\r\n       // this._button2.addClass('handleSelectionExtensionIcon');\r\n        //this._group.addControl(this._button2);\r\n    }\r\n\r\n    drawData() {\r\n        let _this = this;\r\n        console.log(this._data);\r\n        var div = document.getElementById('atbimPanel');\r\n        div.innerHTML = '<canvas id=\"myChart\" width=\"400\" height=\"400\"></canvas>';\r\n        var ctx = document.getElementById('myChart').getContext('2d');\r\n        let keys = Object.keys(this._data);\r\n        let values = Object.values(this._data).map(x => x.cantidad);\r\n        new Chart(ctx, {\r\n            type: 'bar',\r\n            data: {\r\n                labels: keys,\r\n                datasets: [{\r\n                    label: 'Cantidad',\r\n                    data: values,\r\n                    backgroundColor: 'rgba(255, 99, 132, 0.2)',\r\n                    borderColor: 'rgba(255, 99, 132, 1)',\r\n                    borderWidth: 2\r\n                }]\r\n            },\r\n            options: {\r\n                'onClick': function(evento, item) {\r\n                 \r\n                    if (item[0] !== undefined) {\r\n                        let label = item[0]._model.label;\r\n                        let dbIds = _this._data[label].dbIds;                        \r\n                        _this.viewer.isolate(dbIds);\r\n                        _this.viewer.fitToView(dbIds, _this.viewer.model);\r\n                    }\r\n                },\r\n                scales: {\r\n                    yAxes: [{\r\n                        ticks: {\r\n                            beginAtZero: true\r\n                        }\r\n                    }]\r\n                }\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nAutodesk.Viewing.theExtensionManager.registerExtension('HandleSelectionExtension', HandleSelectionExtension);\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}